# incus_storage_volume

Manages an Incus storage volume.

## Example Usage

```hcl
resource "incus_storage_pool" "pool1" {
  name   = "mypool"
  driver = "zfs"
}

resource "incus_storage_volume" "volume1" {
  name = "myvolume"
  pool = incus_storage_pool.pool1.name
}

resource "incus_storage_volume" "volume1_copy" {
  name = "myvolume_copy"
  pool = "default"

  source_volume = {
    name = incus_storage_volume_volume1.name
    pool = incus_storage_pool.pool1.name
  }
}
```

## Example to create volume from backup file

```hcl
resource "incus_storage_volume" "volume_from_backup" {
 name        = "restored-volume"
 pool        = "default"
 source_file = "/path/to/volume.backup"
}
```

## Argument Reference

* `name` - **Required** - Name of the storage volume.

* `pool` - **Required** - Name of storage pool to host the volume.

* `description` - *Optional* - Description of the volume.

* `type` - *Optional* - The "type" of volume. The default value is `custom`,
  which is the type to use for storage volumes attached to instances.

* `content_type` - *Optional* - Volume content type (`filesystem` or `block`)

* `config` - *Optional* - Map of key/value pairs of
  [volume config settings](https://linuxcontainers.org/incus/docs/main/reference/storage_drivers/).
  Config settings vary depending on the Storage Pool used.

* `project` - *Optional* - Name of the project where the volume will be stored.

* `remote` - *Optional* - The remote in which the resource will be created. If
  not provided, the provider's default remote will be used.

* `target` - *Optional* - Specify a target node in a cluster.

* `source_volume` - *Optional* - The source volume from which the volume will be created. See reference below.

* `source_file` - *Optional* - Path to a backup file from which the volume will be created.

The `source_volume` block supports:

* `name` - **Required** - Name of the storage volume.

* `pool` - **Required** - The storage pool that will receive the copy of the volume copy.

* `remote` - *Optional* - The remote in which the resource will be created. If
  not provided, the provider's default remote will be used.

## Attribute Reference

The following attributes are exported:

* `location` - Name of the node where volume was created. It could be useful with Incus in cluster mode.

## Importing

Import ID syntax: `[<remote>:][<project>]/<pool>/<name>`

* `<remote>` - *Optional* - Remote name.
* `<project>` - *Optional* - Project name.
* `<pool>` - **Required** - Storage pool name.
* `<name>` - **Required** - Volume name.

-> Currently, only volumes of type `custom` can be imported.

### Import example

Example using terraform import command:

```shell
terraform import incus_storage_volume.myvol proj/pool1/vol1
```

Example using the import block (only available in Terraform v1.5.0 and later):

```hcl
resource "incus_storage_volume" "myvol" {
  name    = "vol1"
  pool    = "pool1"
  project = "proj"
}

import {
  to = incus_storage_volume.myvol
  id = "proj/pool1/vol1"
}
```

## Notes

* Technically, an Incus volume is simply an instance or profile device of
  type `disk`.

* The volume resource `config` includes some keys that can be automatically generated by the Incus.
  If these keys are not explicitly defined by the user, they will be omitted from the Terraform
  state and treated as computed values.
  * `block.filesystem`
  * `block.mount_options`
  * `volatile.*`
